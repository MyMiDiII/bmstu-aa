\chapter{Исследовательская часть}

\section{Технические характеристики}

Технические характеристики устройства, на котором выполнялось тестирование:

\begin{itemize}
	\item Операционная система: Manjaro \cite{manjaro} Linux x86\_64.
	\item Память: 8 GiB.
    \item Процессор: Intel® Core™ i5-8265U, 4 физических ядра, 8 логических
        ядра\cite{intel}.
\end{itemize}

Тестирование проводилось на ноутбуке, включенном в сеть электропитания. Во
время тестирования ноутбук был нагружен только встроенными приложениями
окружения, окружением, а также непосредственно системой тестирования.

\section{Примеры работы программы}

На рисунке \ref{img:exp} представлены результаты работы программы.

\img{90mm}{img01}{Пример работы программы}{exp}

\section{Результаты тестирования}

Программа была протестирования на входных данных, приведенных в таблице
\ref{tab:tests}. Полученные результаты работы программы совпали с ожидаемыми
результатами.

\section[Постановка эксперимента по замеру времени]
        {Постановка ~~эксперимента ~~по ~~замеру времени}

Для оценки времени работы последовательной и параллельной реализации алгоритма
численного интегрирования методом средних прямоугольников был проведен
эксперимент, в котором определялось влияние количества потоков и точности
вычислений на время работы алгоритмов. Тестирование проводилось на количестве
потоков, равном степеням 2 от 1 до 64, и на точности вычислений от 1 до 7
знаков после запятой. Так как от запуска к запуску время, затрачиваемое на
выполнение алгоритма, менялось в определенном промежутке, необходимо было
усреднить вычисляемые значения. Для этого каждый алгоритм в каждом случае
запускался по 10 раз, и для полученных 10 значений определялось среднее
арифметическое, которое заносилось в таблицу результатов.

Результаты эксперимента были представлены в виде таблиц и графиков, приведенных
в следующем подразделе.

\section{Результаты эксперимента}

В таблице \ref{tab:threads} представлены результаты измерения времени работы
паралелльного алгоритма в зависимости от числа потоков. На рисунке представлен
соответствующий график, для сравнения на графике приведено также время
последовательной реализации.

В таблице \ref{tab:eps} представлены результаты измерения времени работы
последовательного и паралелльного алгоритмов в зависимости от числа знаков
после запятой, соответствующие заданной точности вычислений интеграла. На
рисунке представлен соответствующий график, для наглядости на графике
представлены только точки с точностью от 4 до 7 знаков после запятой.

\begin{table}[h]
    \begin{center}
    \begin{threeparttable}
        \captionsetup{format=hang,justification=raggedright,
                      singlelinecheck=off}
        \caption{\label{tab:threads}Время работы от числа потоков (* -- 
                 последовательный)}
        \begin{tabular}{|r|r|}
            \hline
            \bfseries Число потоков & \bfseries Время, нс
            \csvreader{../data/csv/threads.csv}{}
            {\\\hline \csvcoli&\csvcolii}
            \\\hline
        \end{tabular}
    \end{threeparttable}
    \end{center}
\end{table} 

\img{120mm}{img02}{График зависимости времени работы от числа потоков}{threads}

\begin{table}[h]
    \begin{center}
    \begin{threeparttable}
        \captionsetup{format=hang,justification=raggedright,
                      singlelinecheck=off}
        \caption{\label{tab:eps}Время работы от точности}
        \begin{tabular}{|r|r|r|}
            \hline
            \bfseries Точность & \bfseries 8 потоков, нс
            & \bfseries Последовательный, нс
            \csvreader{../data/csv/eps.csv}{}
            {\\\hline \csvcoli&\csvcolii&\csvcoliii}
            \\\hline
        \end{tabular}
    \end{threeparttable}
    \end{center}
\end{table} 

\img{120mm}{img03}{График зависимости времени работы реализаций от
точности}{threads}

\clearpage
\section{Вывод}

По результатам эксперимента можно сделать следующие выводы:
\begin{itemize}[left=\parindent]
    \item при движении от наименьшего числа потоков к числу потоков равному
        числу логических ядер процессора время уменьшается;
    \item при превышении числа логических ядер время увеличивается, так как
        затрачивается время на переключение ядра между потоками;
    \item последовательная реализация работает примерно в 3 раза медленнее
        параллельной реализации на оптимальном числе потоков (8);
    \item при этом параллельная реализация только при числе потоков большем 32
        работает медленнее, что говорит о том, что при таком числе реализуемых
        потоков выигрыш от распараллеливания перекрывается временем,
        затрачиваемым на переключения между потоками;
    \item в зависимости от точности выигрыш от распараллеливания начинает
        проявляться только при точности от 5 и выше знаков после запятой
        (выигрыш примерно в 2 раза); это значит, что меньшей точности время,
        затрачиваемое на создание и запуск потоков, больше чем выигрыш,
        получаемый от распараллеливания.
\end{itemize}

Таким образом, для достижения наибольшей скорости вычислений необходимо
использовать число потоков равное числу логических потоков на машине. При этом
нецелесообразно использовать параллельную реализацию при проведении вычислений
интегралов с точностью ниже, чем 5 знаков после запятой. В таком случае,
необходимо либо использовать параллельную реализацию, либо уменьшить число
потоков, чтобы затрачивать меньше времени на их создание.
